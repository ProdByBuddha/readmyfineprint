> readmyfineprint@2.0.0 start:staging
> NODE_ENV=staging concurrently "tsx server/production.ts" "node scripts/local-l[1] ğŸš€ Local LLM server running on port 11434
[1] ğŸ“¡ Compatible with Ollama API endpoints
[1] ğŸ” Ready for PII detection requests
[1] ğŸ›‘ Press Ctrl+C to stop
[2] 
[2] > readmyfineprint@2.0.0 monitor:continuous
[2] > node scripts/production-monitor.js --continuous
[2] 
[2] ğŸš€ Production Monitor initialized for staging environment
[2] ğŸ“§ Email alerts enabled for: prodbybuddha@icloud.com
[2] ğŸš€ Starting continuous production monitoring...
[2] ğŸ“Š Environment: staging
[2] â° Check interval: 120 seconds
[2] Press Ctrl+C to stop
[2] 
[2] â³ Waiting 15 seconds for staging server to start...
[0] âœ“ Consent logging enabled with PostgreSQL database
[0] Blog Scheduler initialized with config: {
[0]   enabled: false,
[0]   postsPerDay: 3,
[0]   hours: [ 9, 13, 17 ],
[0]   maxPostsPerHour: 1,
[0]   timezone: 'America/New_York',
[0]   minHoursBetweenPosts: 4
[0] }
[0] âœ… JWT Secret Manager initialized with versioned secrets
[0] ğŸ“‹ Initialized 4 disaster recovery scenarios
[0] ğŸ” Started continuous health monitoring
[0] ğŸ”‘ Using Stripe key: sk_live_51RWnyY... (test mode: false)
[0] ğŸš€ Starting ReadMyFinePrint Production Server...
[0] ğŸ” Validating environment variables...
[0] âœ… OPENAI_API_KEY: sk-***
[0] âœ… ADMIN_API_KEY: 81ad52472ab148577fb4ba109d09901d1e9b5d55479ccebbea...
[0] âœ… JWT_SECRET: KQvWGiKq5jAfsTSHFID1StgprPQAusDKhJmSdVFKgZI5W/nF2O...
[0] âœ… TOKEN_ENCRYPTION_KEY: ddf455b6fd8c0e59d5893bf44e7bca157c0ad51405258c7bee...
[0] âœ… PASSWORD_PEPPER: b0dea38aca02ad50d94b704f127740decf0e4839b66c6f145d...
[0] âœ… ALLOWED_ORIGINS: https://readmyfineprint.com,https://edcf3ef7-a826-...
[0] âœ… NODE_ENV: staging
[0] âœ… SESSION_ENCRYPTION_KEY: 2651fc8605cabc8b756adbc6861138afe8cf520d54417763ee...
[0] âœ… REPLIT_DB_URL: https://kv.replit.com/v0/eyJhbGciOiJIUzUxMiIsImlzc...
[0] ğŸš§ Running in staging environment
[0] âœ… STRIPE_PUBLIC_KEY: pk_live_51RWnyYLNxaR...
[0] âœ… STRIPE_SECRET_KEY: sk_live_51...
[0] âœ… STRIPE_TEST_PUBLIC_KEY: pk_test_51RWnynPxX1d...
[0] âœ… STRIPE_TEST_SECRET_KEY: sk_test_51...
[0] ğŸ”„ Concurrent test/live payment processing enabled
[0] 
[0] ğŸ“‹ Warnings:
[0]    âš ï¸  Optional SECURITY_WEBHOOK_URL not set - Optional webhook URL for security alerts (for external monitoring)
[0] âœ… Environment validation passed
[0]    (1 warning)
[0] 
[0] ğŸ”§ Environment Configuration:
[0]    Environment: staging
[0]    OpenAI API: âœ… Configured
[0]    Admin Auth: âœ… Configured
[0]    CORS Origins: https://readmyfineprint.com,https://edcf3ef7-a826-4eed-8e04-7a485b2e183a-00-1wyt...
[0] 
[0] âœ… Secure JWT Service initialized with refresh token support
[0] Warning: Indexing all PDF objects
[0] ğŸ“… Backup schedules configured
[0] âœ… Backup service initialized with automated scheduling
[0] â„¹ï¸ [SECURITY] SYSTEM | LOW | caf37866 | JWT Secret Manager initialized successfully | initialization
[0] ğŸ” Checking database migrations...
[0] â„¹ï¸ [SECURITY] SYSTEM | LOW | f15f50b0 | Secure JWT Service initialized | initialization
[0] â„¹ï¸ [SECURITY] SYSTEM | LOW | 1f81d322 | Backup service initialized successfully | initialization
[0] âœ… Email service configured and verified with SMTP (smtp.mail.me.com)
[0] âœ… Database schema is up to date
[0] âœ… Two-Factor Authentication routes registered
[0] ğŸ“‹ Production server running on http://0.0.0.0:5000
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Checking session-based authentication...
[0] Consent verification request - IP: 10.82.9.65, UA: Mozilla/5.0 (Windows..., User: none, Session: 95df0cd7498a5b0900375af079720126
[0] Generated pseudonym 905c19b33c072b9392497ff4 from identifier: session:95df0cd7498a5b0900375af079720126...
[0] Verifying consent for pseudonym: 905c19b33c072b9392497ff4 (IP: 10.82.9.65, UA: Mozilla/5.0 (Windows..., User: none, Session: 95df0cd7498a5b09)
[0] Consent verification result for 905c19b33c072b9392497ff4: false 
[0] Consent verification response: false (session: 95df0cd7498a5b0900375af079720126)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] Consent verification request - IP: 10.82.5.55, UA: Mozilla/5.0 (Windows..., User: none, Session: 95df0cd7498a5b0900375af079720126
[0] Generated pseudonym 905c19b33c072b9392497ff4 from identifier: session:95df0cd7498a5b0900375af079720126...
[0] Verifying consent for pseudonym: 905c19b33c072b9392497ff4 (IP: 10.82.5.55, UA: Mozilla/5.0 (Windows..., User: none, Session: 95df0cd7498a5b09)
[0] Using cached consent result for 905c19b33c072b9392497ff4: false
[0] Consent verification response: false (session: 95df0cd7498a5b0900375af079720126)
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] âš ï¸ [SECURITY] AUTHENTICATION | HIGH | d2b52606 | Failed authentication attempt: Authentication required | /api/security-questions/user | {"reason":"Authentication required"}
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] âš ï¸ [SECURITY] AUTHENTICATION | HIGH | f845e1ed | Failed authentication attempt: Authentication required | /api/security-questions/user | {"reason":"Authentication required"}
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] âš ï¸ [SECURITY] AUTHENTICATION | HIGH | f845e1ed | Failed authentication attempt: Authentication required | /api/security-questions/user | {"reason":"Authentication required"}
[0] Consent verification request - IP: 10.82.1.36, UA: Mozilla/5.0 (Windows..., User: none, Session: 95df0cd7498a5b0900375af079720126
[0] Generated pseudonym 905c19b33c072b9392497ff4 from identifier: session:95df0cd7498a5b0900375af079720126...
[0] Verifying consent for pseudonym: 905c19b33c072b9392497ff4 (IP: 10.82.1.36, UA: Mozilla/5.0 (Windows..., User: none, Session: 95df0cd7498a5b09)
[0] Using cached consent result for 905c19b33c072b9392497ff4: false
[0] Consent verification response: false (session: 95df0cd7498a5b0900375af079720126)
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] âœ… JOSE Auth Service initialized with key length: 32 bytes
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] â„¹ï¸ [SECURITY] SYSTEM | LOW | b4080c56 | JOSE Auth Service initialized | initialization
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: '95df0cd7...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ§¹ Cleaned up 0 expired refresh tokens and 0 expired revocations
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] Session cleanup completed: 0 expired sessions removed
[0] ğŸ§¹ Startup cleanup: 0 expired tokens removed, 0 expired sessions removed
[2] 
[2] ğŸ” Production Health Check - 2025-08-03T22:37:20.290Z
[2] ğŸŒ Environment: staging
[2] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[2] âœ… SERVER: Server responding normally
[2] âœ… DATABASE: Server responding normally
[0] âœ… Email configuration test successful
[2] âœ… EMAIL: Email service configured and ready
[2] âœ… PROCESSES: 27 server processes running
[2] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[2] Overall Status: âœ… HEALTHY
[0] ğŸ”€ Redirecting Stripe checkout to: https://edcf3ef7-a826-4eed-8e04-7a485b2e183a-00-1wytaob2mj6u8.kirk.replit.dev/subscription
[0] ğŸ” Checking session-based authentication...
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] âš ï¸ [SECURITY] AUTHENTICATION | HIGH | e1720fdb | Failed authentication attempt: Authentication required | /api/security-questions/user | {"reason":"Authentication required"}
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] Consent verification request - IP: 10.82.1.36, UA: Mozilla/5.0 (Windows..., User: c970c8a1-3a9d-43e0-b758-e5092db524ff, Session: b9c1744c1d1aba2684c6b58241c06c38
[0] Generated pseudonym 640a3f32e1423e43fbfa24e3 from identifier: user:c970c8a1-3a9d-43e0-b758-e5092db524ff...
[0] Verifying consent for pseudonym: 640a3f32e1423e43fbfa24e3 (IP: 10.82.1.36, UA: Mozilla/5.0 (Windows..., User: c970c8a1-3a9d-43e0-b758-e5092db524ff, Session: b9c1744c1d1aba26)
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] Consent verification result for 640a3f32e1423e43fbfa24e3: true (ID: 62f3f73841ebc622f4f67b94)
[0] Consent verification response: true (session: b9c1744c1d1aba2684c6b58241c06c38)
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] â„¹ï¸ [SECURITY] USER_ACTIVITY | LOW | 1b0f7802 | User retrieved cookie consent preferences | /api/user/preferences/cookie-consent | {"userId":"c970c8a1-3a9d-43e0-b758-e5092db524ff","cookieConsent":null}
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] â„¹ï¸ [SECURITY] USER_ACTIVITY | LOW | 1b0f7802 | User retrieved cookie consent preferences | /api/user/preferences/cookie-consent | {"userId":"c970c8a1-3a9d-43e0-b758-e5092db524ff","cookieConsent":null}
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] â„¹ï¸ [SECURITY] USER_ACTIVITY | LOW | 1b0f7802 | User retrieved cookie consent preferences | /api/user/preferences/cookie-consent | {"userId":"c970c8a1-3a9d-43e0-b758-e5092db524ff","cookieConsent":null}
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] ğŸ” Checking session-based authentication...
[0] â„¹ï¸ [SECURITY] USER_ACTIVITY | LOW | 1b0f7802 | User retrieved cookie consent preferences | /api/user/preferences/cookie-consent | {"userId":"c970c8a1-3a9d-43e0-b758-e5092db524ff","cookieConsent":null}
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] [Subscription Enforcement] Valid subscription: Free tier assigned
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] â„¹ï¸ [SECURITY] USER_ACTIVITY | LOW | e1720fdb | User retrieved cookie consent preferences | /api/user/preferences/cookie-consent | {"userId":"c970c8a1-3a9d-43e0-b758-e5092db524ff","cookieConsent":null}
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] ğŸ” Admin auth attempt for /api/admin/metrics-subscription
[0] ğŸ” Admin auth attempt for /api/admin/system-health-subscription
[0] ğŸ” Admin auth attempt for /api/admin/activity-subscription
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] âœ… Admin access granted via JWT: admin@readmyfineprint.com
[0] âœ… Admin access granted via JWT: admin@readmyfineprint.com
[0] âœ… Admin access granted via JWT: admin@readmyfineprint.com
[0] ğŸ” [SECURITY] AUTHENTICATION | MEDIUM | 1b0f7802 | Admin authentication successful | /api/admin/activity-subscription (JWT admin)
[0] ğŸ” [SECURITY] AUTHENTICATION | MEDIUM | d2b52606 | Admin authentication successful | /api/admin/metrics-subscription (JWT admin)
[0] ğŸ” [SECURITY] AUTHENTICATION | MEDIUM | e1720fdb | Admin authentication successful | /api/admin/system-health-subscription (JWT admin)
[0] âš ï¸ [SECURITY] AUTHENTICATION | HIGH | 1b0f7802 | Failed authentication attempt: Admin access denied: subscription token required | /admin/posts | {"reason":"Admin access denied: subscription token required"}
[0] âš ï¸ [SECURITY] AUTHENTICATION | HIGH | 1b0f7802 | Failed authentication attempt: Admin access denied: subscription token required | /admin/topics | {"reason":"Admin access denied: subscription token required"}
[0] âš ï¸ [SECURITY] AUTHENTICATION | HIGH | 1b0f7802 | Failed authentication attempt: Admin access denied: subscription token required | /admin/scheduler/status | {"reason":"Admin access denied: subscription token required"}
[0] âš ï¸ [SECURITY] AUTHENTICATION | HIGH | 1b0f7802 | Failed authentication attempt: Admin access denied: subscription token required | /admin/stats | {"reason":"Admin access denied: subscription token required"}
[0] âš ï¸ [SECURITY] AUTHENTICATION | HIGH | 1b0f7802 | Failed authentication attempt: Admin access denied: subscription token required | /admin/posts/deleted | {"reason":"Admin access denied: subscription token required"}
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] âœ… Admin access granted via JWT: admin@readmyfineprint.com
[0] ğŸ” [SECURITY] AUTHENTICATION | MEDIUM | 1b0f7802 | Admin authentication successful | /api/admin/analytics-subscription (JWT admin)
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] ğŸ” Checking session-based authentication...
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] ğŸ” Checking session-based authentication...
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'missing',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] ğŸ” Checking authenticated user session...
[0] ğŸ” Token lookup result: { found: false, tokenPrefix: 'none' }
[0] âŒ No token found for session
[0] [Subscription Enforcement] Valid subscription: Free tier assigned
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] Consent verification request - IP: 10.82.8.98, UA: Mozilla/5.0 (Windows..., User: c970c8a1-3a9d-43e0-b758-e5092db524ff, Session: b9c1744c1d1aba2684c6b58241c06c38
[0] Generated pseudonym 640a3f32e1423e43fbfa24e3 from identifier: user:c970c8a1-3a9d-43e0-b758-e5092db524ff...
[0] Verifying consent for pseudonym: 640a3f32e1423e43fbfa24e3 (IP: 10.82.8.98, UA: Mozilla/5.0 (Windows..., User: c970c8a1-3a9d-43e0-b758-e5092db524ff, Session: b9c1744c1d1aba26)
[0] Consent verification result for 640a3f32e1423e43fbfa24e3: true (ID: 62f3f73841ebc622f4f67b94)
[0] Consent verification response: true (session: b9c1744c1d1aba2684c6b58241c06c38)
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] â„¹ï¸ [SECURITY] USER_ACTIVITY | LOW | 1b0f7802 | User retrieved cookie consent preferences | /api/user/preferences/cookie-consent | {"userId":"c970c8a1-3a9d-43e0-b758-e5092db524ff","cookieConsent":null}
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] ğŸ” Session validation request: {
[0]   sessionId: 'f2a2a65b...',
[0]   clientSessionId: 'b9c1744c...',
[0]   cookies: [],
[0]   headers: {
[0]     cookie: 'present',
[0]     authorization: 'present',
[0]     'x-session-id': 'present'
[0]   }
[0] }
[0] âœ… JWT authentication successful for user: admin@readmyfineprint.com
[0] âœ… Valid JOSE access token for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[0] ğŸ”‘ User authenticated via secure JWT: admin@readmyfineprint.com (c970c8a1-3a9d-43e0-b758-e5092db524ff)
[0] â„¹ï¸ [SECURITY] USER_ACTIVITY | LOW | d2b52606 | User retrieved cookie consent preferences | /api/user/preferences/cookie-consent | {"userId":"c970c8a1-3a9d-43e0-b758-e5092db524ff","cookieConsent":null}
[2] 
[2] ğŸ” Production Health Check - 2025-08-03T22:39:20.726Z
[2] ğŸŒ Environment: staging
[2] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[2] âœ… SERVER: Server responding normally
[2] âœ… DATABASE: Server responding normally
[0] âœ… Email configuration test successful
[2] âœ… EMAIL: Email service configured and ready
[2] âœ… PROCESSES: 27 server processes running
[2] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[2] Overall Status: âœ… HEALTHY