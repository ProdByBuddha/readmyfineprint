
> readmyfineprint@2.0.0 start:staging
> NODE_ENV=staging concurrently "tsx server/production.ts" "node scripts/local-llm-server.cjs" "npm run monitor:continuous"

[1] ğŸš€ Local LLM server running on port 11434
[1] ğŸ“¡ Compatible with Ollama API endpoints
[1] ğŸ” Ready for PII detection requests
[1] ğŸ›‘ Press Ctrl+C to stop
[2] 
[2] > readmyfineprint@2.0.0 monitor:continuous
[2] > node scripts/production-monitor.js --continuous
[2] 
[2] ğŸš€ Production Monitor initialized for staging environment
[2] ğŸ“§ Email alerts enabled for: prodbybuddha@icloud.com
[2] ğŸš€ Starting continuous production monitoring...
[2] ğŸ“Š Environment: staging
[2] â° Check interval: 120 seconds
[2] Press Ctrl+C to stop
[2] 
[[0] âœ“ Consent logging enabled with PostgreSQL database.
[0] Blog Scheduler initialized with config: {
[0]   enabled: false,
[0]   postsPerDay: 3,
[0]   hours: [ 9, 13, 17 ],
[0]   maxPostsPerHour: 1,
[0]   timezone: 'America/New_York',
[0]   minHoursBetweenPosts: 4
[0] }
[0] âœ… JWT Secret Manager initialized with versioned secrets
[0] ğŸ“‹ Initialized 4 disaster recovery scenarios
[0] ğŸ” Started continuous health monitoring
[0] ğŸ”‘ Using Stripe key: sk_live_51RWnyY... (test mode: false)
[0] ğŸš€ Starting ReadMyFinePrint Production Server...
[0] ğŸ” Validating environment variables...
[0] âœ… OPENAI_API_KEY: sk-***
[0] âœ… ADMIN_API_KEY: 81ad52472ab148577fb4ba109d09901d1e9b5d55479ccebbea...
[0] âœ… JWT_SECRET: KQvWGiKq5jAfsTSHFID1StgprPQAusDKhJmSdVFKgZI5W/nF2O...
[0] âœ… TOKEN_ENCRYPTION_KEY: ddf455b6fd8c0e59d5893bf44e7bca157c0ad51405258c7bee...
[0] âœ… PASSWORD_PEPPER: b0dea38aca02ad50d94b704f127740decf0e4839b66c6f145d...
[0] âœ… ALLOWED_ORIGINS: https://readmyfineprint.com,https://edcf3ef7-a826-...
[0] âœ… NODE_ENV: staging
[0] âœ… SESSION_ENCRYPTION_KEY: 2651fc8605cabc8b756adbc6861138afe8cf520d54417763ee...
[0] âœ… REPLIT_DB_URL: https://kv.replit.com/v0/eyJhbGciOiJIUzUxMiIsImlzc...
[0] ğŸš§ Running in staging environment
[0] âœ… STRIPE_PUBLIC_KEY: pk_live_51RWnyYLNxaR...
[0] âœ… STRIPE_SECRET_KEY: sk_live_51...
[0] âœ… STRIPE_TEST_PUBLIC_KEY: pk_test_51RWnynPxX1d...
[0] âœ… STRIPE_TEST_SECRET_KEY: sk_test_51...
[0] ğŸ”„ Concurrent test/live payment processing enabled
[0] 
[0] ğŸ“‹ Warnings:
[0]    âš ï¸  Optional SECURITY_WEBHOOK_URL not set - Optional webhook URL for security alerts (for external monitoring)
[0] âœ… Environment validation passed
[0]    (1 warning)
[0] 
[0] ğŸ”§ Environment Configuration:
[0]    Environment: staging
[0]    OpenAI API: âœ… Configured
[0]    Admin Auth: âœ… Configured
[0]    CORS Origins: https://readmyfineprint.com,https://edcf3ef7-a826-4eed-8e04-7a485b2e183a-00-1wyt...
[0] 
[0] âœ… Secure JWT Service initialized with refresh token support
[0] Warning: Indexing all PDF objects
[0] ğŸ“… Backup schedules configured
[0] âœ… Backup service initialized with automated scheduling
[0] â„¹ï¸ [SECURITY] SYSTEM | LOW | caf37866 | JWT Secret Manager initialized successfully | initialization
[0] ğŸ” Checking database migrations...
[0] â„¹ï¸ [SECURITY] SYSTEM | LOW | f15f50b0 | Secure JWT Service initialized | initialization
[0] â„¹ï¸ [SECURITY] SYSTEM | LOW | 1f81d322 | Backup service initialized successfully | initialization
[0] âœ… Email service configured and verified with SMTP (smtp.mail.me.com)
[0] âœ… Database schema is up to date
[0] âœ… Two-Factor Authentication routes registered
[0] TypeError: Missing parameter name at 1: https://git.new/pathToRegexpError
[0]     at name (/home/runner/workspace/node_modules/path-to-regexp/src/index.ts:153:13)
[0]     at lexer (/home/runner/workspace/node_modules/path-to-regexp/src/index.ts:171:21)
[0]     at lexer.next (<anonymous>)
[0]     at Iter.peek (/home/runner/workspace/node_modules/path-to-regexp/src/index.ts:188:32)
[0]     at Iter.tryConsume (/home/runner/workspace/node_modules/path-to-regexp/src/index.ts:195:24)
[0]     at Iter.text (/home/runner/workspace/node_modules/path-to-regexp/src/index.ts:213:26)
[0]     at consume (/home/runner/workspace/node_modules/path-to-regexp/src/index.ts:285:23)
[0]     at parse (/home/runner/workspace/node_modules/path-to-regexp/src/index.ts:320:18)
[0]     at <anonymous> (/home/runner/workspace/node_modules/path-to-regexp/src/index.ts:503:40)
[0]     at Array.map (<anonymous>)
[0]     at pathToRegexp (/home/runner/workspace/node_modules/path-to-regexp/src/index.ts:502:23)
[0]     at Object.match (/home/runner/workspace/node_modules/path-to-regexp/src/index.ts:461:28)
[0]     at matcher (/home/runner/workspace/node_modules/router/lib/layer.js:86:23)
[0]     at new Layer (/home/runner/workspace/node_modules/router/lib/layer.js:93:62)
[0]     at Function.route (/home/runner/workspace/node_modules/router/index.js:428:17)
[0]     at Function.route (/home/runner/workspace/node_modules/express/lib/application.js:257:22)
[0] âœ… JOSE Auth Service initialized with key length: 32 bytes
[0] â„¹ï¸ [SECURITY] SYSTEM | LOW | b4080c56 | JOSE Auth Service initialized | initialization
[0] ğŸ§¹ Cleaned up 0 expired refresh tokens and 0 expired revocations
[0] Session cleanup completed: 0 expired sessions removed
[0] ğŸ§¹ Startup cleanup: 0 expired tokens removed, 0 expired sessions removed
[2] 
[2] ğŸ” Production Health Check - 2025-08-04T11:07:26.806Z
[2] ğŸŒ Environment: staging
[2] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[2] âŒ SERVER: Connection refused - server may be down
[2] âŒ DATABASE: Connection refused - server may be down
[2] âŒ EMAIL: Email health check failed: request to http://localhost:5000/api/monitoring/test-email failed, reason: connect ECONNREFUSED 127.0.0.1:5000
[2] âœ… PROCESSES: 21 server processes running
[2] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[2] Overall Status: âŒ ISSUES DETECTED
[2] 
[2] ğŸš¨ Critical Issues:
[2]   â€¢ server: Connection refused - server may be down
[2]   â€¢ database: Connection refused - server may be down
[2]   â€¢ email: Email health check failed: request to http://localhost:5000/api/monitoring/test-email failed, reason: connect ECONNREFUSED 127.0.0.1:5000
[2] âŒ Failed to send email alert: request to http://localhost:5000/api/monitoring/send-alert-email failed, reason: connect ECONNREFUSED 127.0.0.1:5000
[2] 
[2] ğŸ” Production Health Check - 2025-08-04T11:09:26.992Z
[2] ğŸŒ Environment: staging
[2] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[2] âŒ SERVER: Connection refused - server may be down
[2] ğŸš¨ ALERT: server has failed 3 consecutive times!
[2] âŒ Failed to send email alert: request to http://localhost:5000/api/monitoring/send-alert-email failed, reason: connect ECONNREFUSED 127.0.0.1:5000
[2] âŒ DATABASE: Connection refused - server may be down
[2] âŒ EMAIL: Email health check failed: request to http://localhost:5000/api/monitoring/test-email failed, reason: connect ECONNREFUSED 127.0.0.1:5000
[2] âœ… PROCESSES: 21 server processes running
[2] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[2] Overall Status: âŒ ISSUES DETECTED
[2] 
[2] ğŸš¨ Critical Issues:
[2]   â€¢ server: Connection refused - server may be down
[2]   â€¢ database: Connection refused - server may be down
[2]   â€¢ email: Email health check failed: request to http://localhost:5000/api/monitoring/test-email failed, reason: connect ECONNREFUSED 127.0.0.1:5000
[2] âŒ Failed to send email alert: request to http://localhost:5000/api/monitoring/send-alert-email failed, reason: connect ECONNREFUSED 127.0.0.1:5000