> rest-express@1.0.0 dev
âœ“ Consent logging enabled with Replit KV store
âœ… JOSE token service initialized with encryption key
ğŸš€ Starting ReadMyFinePrint Server...
ğŸ” Validating environment variables...
âœ… OPENAI_API_KEY: sk-***
âœ… ADMIN_API_KEY: 56fe020d923e89b5a8c39962e3e29dd4cb3ad58fcb46800782...
âœ… ALLOWED_ORIGINS: https://readmyfineprint.com,https://edcf3ef7-a826-...
âœ… NODE_ENV: development
âœ… SESSION_ENCRYPTION_KEY: 2651fc8605cabc8b756adbc6861138afe8cf520d54417763ee...
âœ… REPLIT_DB_URL: https://kv.replit.com/v0/eyJhbGciOiJIUzUxMiIsImlzc...
âœ… TOKEN_ENCRYPTION_KEY: ddf455b6fd8c0e59d5893bf44e7bca157c0ad51405258c7bee...
âœ… PASSWORD_PEPPER: b0dea38aca02ad50d94b704f127740decf0e4839b66c6f145d...
âœ… STRIPE_PUBLIC_KEY: pk_live_51RWnyYLNxaR...
âœ… STRIPE_SECRET_KEY: sk_live_51...
âœ… STRIPE_TEST_PUBLIC_KEY: pk_test_51RWnynPxX1d...
âœ… STRIPE_TEST_SECRET_KEY: sk_test_51...
ğŸ”„ Concurrent test/live payment processing enabled

ğŸ“‹ Warnings:
   âš ï¸  Optional SECURITY_WEBHOOK_URL not set - Optional webhook URL for security alerts (for external monitoring)
âœ… Environment validation passed
   (1 warning)

ğŸ”§ Environment Configuration:
   Environment: development
   OpenAI API: âœ… Configured
   Admin Auth: âœ… Configured
   CORS Origins: https://readmyfineprint.com,https://edcf3ef7-a826-4eed-8e04-7a485b2e183a-00-1wyt...

ğŸ”§ Initializing collective free tier user routing...
Warning: Indexing all PDF objects
âœ… Email service configured and verified with SMTP (smtp.mail.me.com)
âœ… Collective free tier user routing initialized
4:46:15 AM [express] serving on port 5000
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | ad008939 | New session created
ğŸ“ New session logged for client: b0b978bc280115725c7154af23eb6a3f
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | b1c859b2 | New session created
ğŸ“ New session logged for client: 7e1abce4b5c97f487fac392238ead375
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | 5948a372 | New session created
ğŸ“ New session logged for client: 7b9cca145c50e07e2dcdc0dd9359f5e4
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | 7e3ab120 | New session created
ğŸ“ New session logged for client: 9804d0ebe2e03b3982f935dcc27fb7d2
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | 079f9cf6 | New session created
ğŸ“ New session logged for client: 99b21d2d0b6420ddd50fdf4a64e1d085
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | 02c43f44 | New session created
ğŸ“ New session logged for client: 2ee7b390dc9eae80fc8505d36436f22f
ğŸ”‘ GET /api/documents | Session: 2789063010c14ae4733467e4d2e706e8 (EXISTING)
4:46:20 AM [express] GET /api/documents 304 in 2ms :: []
ğŸ”‘ GET /api/documents | Session: 3dbba68a4388247dcb9f49aa52f30829 (EXISTING)
4:46:23 AM [express] GET /api/documents 304 in 1ms :: []
Cleanup completed: 0 expired tokens removed
ğŸ§¹ Startup cleanup: 0 expired tokens removed
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | 02c43f44 | New session created
ğŸ“ New session logged for client: 91454dbece7f029e4e3773d73819b9d8
[Subscription Enforcement] Invalid tier ID: ultimate, defaulting to free
âœ… Generated verification code for admin@readmyfineprint.com (expires: 2025-06-24T04:57:08.130Z)
âœ… Email sent successfully: {
  messageId: '<f2f91b64-1bd1-121a-2cb6-7faf02c3042f@readmyfineprint.com>',
  recipient: 'admin@readmyfineprint.com',
  subject: 'Your ReadMyFinePrint Verification Code'
}
ğŸ“§ Verification code sent to admin@readmyfineprint.com
4:47:08 AM [express] POST /api/subscription/login/request-code 200 in 1249ms :: {"success":true,"mesâ€¦
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | 02c43f44 | New session created
ğŸ“ New session logged for client: b7df91278ab4f2e80ee2f7e90395fb71
âœ… Email verification successful for admin@readmyfineprint.com
[Subscription Enforcement] Invalid tier ID: ultimate, defaulting to free
[Subscription Enforcement] Invalid tier ID: ultimate, defaulting to free
ğŸ”„ Hybrid token generation for user c970c8a1-3a9d-43e0-b758-e5092db524ff, JOSE enabled: true
ğŸ¯ Attempting JOSE token generation...
Generated JOSE subscription token for user c970c8a1-3a9d-43e0-b758-e5092db524ff (expires in 30 days)
âœ… Generated JOSE subscription token for user c970c8a1-3a9d-43e0-b758-e5092db524ff: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
Generated secure subscription token for user c970c8a1-3a9d-43e0-b758-e5092db524ff (expires in 30 days)
4:47:53 AM [express] POST /api/subscription/login/verify 200 in 695ms :: {"success":true,"token":"eyâ€¦
ğŸ” Validating token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiO... (length: 521)
Valid JOSE subscription token for user c970c8a1-3a9d-43e0-b758-e5092db524ff, tier: free
ğŸ” Token validation result: SUCCESS
ğŸ” Token data: userId=c970c8a1-3a9d-43e0-b758-e5092db524ff, tierId=free
4:47:54 AM [express] POST /api/users/validate-token 200 in 4ms :: {"valid":true,"userId":"c970c8a1-3â€¦
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | 079f9cf6 | New session created
ğŸ“ New session logged for client: 7c05232158cf73cbae99fc1dda4e51eb
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | 5948a372 | New session created
ğŸ“ New session logged for client: d3c3449bc03008ff49aec32609ad4894
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | b1c859b2 | New session created
ğŸ“ New session logged for client: 6878f7ed922e485988775d42cae16223
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | 7e3ab120 | New session created
ğŸ“ New session logged for client: 9506a08bf55396414011c23d0b7af8b8
ğŸ”‘ GET /api/documents | Session: 3dbba68a4388247dcb9f49aa52f30829 (EXISTING)
4:47:55 AM [express] GET /api/documents 304 in 0ms :: []
ğŸ” Validating token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiO... (length: 521)
Valid JOSE subscription token for user c970c8a1-3a9d-43e0-b758-e5092db524ff, tier: free
ğŸ” Token validation result: SUCCESS
ğŸ” Token data: userId=c970c8a1-3a9d-43e0-b758-e5092db524ff, tierId=free
4:47:55 AM [express] POST /api/users/validate-token 200 in 1ms :: {"valid":true,"userId":"c970c8a1-3â€¦
â„¹ï¸ [SECURITY] SESSION_MANAGEMENT | LOW | 5948a372 | New session created
ğŸ“ New session logged for client: 4dfbc74f5f79fdf3929c82ea8bc7cef7
Valid JOSE subscription token for user c970c8a1-3a9d-43e0-b758-e5092db524ff, tier: free
Token used from device: fp_MTUzNng4NjR8Q... for user c970c8a1-3a9d-43e0-b758-e5092db524ff
[Subscription Enforcement] Invalid tier ID: ultimate, defaulting to free
4:48:03 AM [express] GET /api/user/subscription 200 in 186ms :: {"subscription":{"id":"25bcc853-a95eâ€¦