"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1173],{6069:(e,t,n)=>{function r(){let e=sessionStorage.getItem("app-session-id");return e||(e=crypto.getRandomValues(new Uint8Array(16)).reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""),sessionStorage.setItem("app-session-id",e),console.log("Generated new session ID:",e)),e}function s(e){let t=sessionStorage.getItem("app-session-id");e&&e!==t&&(sessionStorage.setItem("app-session-id",e),console.log("Updated session ID:",e))}function a(e){return 403===e.status}function o(){window.dispatchEvent(new CustomEvent("consentRequired",{detail:{reason:"API request blocked - consent required"}}))}async function i(e){if(!e.ok){let t=await e.text()||e.statusText;if(a(e))try{let e=JSON.parse(t);"CONSENT_REQUIRED"===e.code&&o()}catch(e){o()}throw Error("".concat(e.status,": ").concat(t))}}async function c(e,t,n){let i=(null==n?void 0:n.headers)||{},c={"x-session-id":r(),...i};(null==n?void 0:n.body)&&(c["Content-Type"]="application/json");let l=await fetch(t,{method:e,headers:c,body:(null==n?void 0:n.body)?JSON.stringify(n.body):void 0,credentials:"include"}),u=l.headers.get("x-session-id");if(u&&s(u),!l.ok){let e=await l.text();if(a(l))try{let t=JSON.parse(e);"CONSENT_REQUIRED"===t.code&&o()}catch(e){o()}throw Error("HTTP ".concat(l.status,": ").concat(e))}return l}n.d(t,{AT:()=>c,qQ:()=>l});let l=new(n(87017)).E({defaultOptions:{queries:{queryFn:(e=>{let{on401:t}=e;return async e=>{let{queryKey:n}=e,c=await fetch(n[0],{headers:{"x-session-id":r()},credentials:"include"}),l=c.headers.get("x-session-id");if(l&&s(l),"returnNull"===t&&401===c.status)return null;if(a(c)){let e=await c.text();try{let t=JSON.parse(e);"CONSENT_REQUIRED"===t.code&&o()}catch(e){o()}throw Error("HTTP ".concat(c.status,": ").concat(e))}return await i(c),await c.json()}})({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,refetchIntervalInBackground:!1,notifyOnChangeProps:["data","error"],staleTime:1/0,gcTime:864e5,retry:!1,structuralSharing:!1},mutations:{retry:!1,onError:e=>{var t,n;(null==e||null==(t=e.message)?void 0:t.includes("403"))&&(null==e||null==(n=e.message)?void 0:n.includes("CONSENT_REQUIRED"))&&(console.log("Mutation error indicates consent required, triggering consent modal"),o())}}}})},21173:(e,t,n)=>{n.r(t),n.d(t,{MobileAppWrapper:()=>i});var r=n(95155),s=n(53904),a=n(12115),o=n(6069);function i(e){let{children:t,className:n=""}=e,i=function(){let[e,t]=a.useState(void 0);return a.useEffect(()=>{let e=window.matchMedia("(max-width: ".concat(767,"px)")),n=()=>{t(window.innerWidth<768)};return e.addEventListener("change",n),t(window.innerWidth<768),()=>e.removeEventListener("change",n)},[]),!!e}(),{containerRef:c,isPulling:l,isRefreshing:u,pullDistance:d,canRefresh:h}=function(e){let{onRefresh:t,threshold:n=80,resistance:r=2.5,enabled:s=!0}=e,[o,i]=(0,a.useState)(!1),[c,l]=(0,a.useState)(!1),[u,d]=(0,a.useState)(0),h=(0,a.useRef)(0),f=(0,a.useRef)(0),m=(0,a.useRef)(null),p=(0,a.useCallback)(e=>{s&&((e.target.closest(".overflow-y-auto")||document.documentElement).scrollTop>0||(h.current=e.touches[0].clientY,f.current=e.touches[0].clientY))},[s]),v=(0,a.useCallback)(e=>{if(!s||!h.current||(e.target.closest(".overflow-y-auto")||document.documentElement).scrollTop>0)return;f.current=e.touches[0].clientY;let t=f.current-h.current;if(t>20){e.preventDefault();let s=Math.min(t/r,1.5*n);d(s),s>=n&&!o?(i(!0),"vibrate"in navigator&&navigator.vibrate(50)):s<n&&o&&i(!1)}},[s,n,r,o]),y=(0,a.useCallback)(async()=>{if(s){if(o&&u>=n){l(!0);try{await t()}catch(e){console.error("Refresh error:",e)}finally{l(!1)}}i(!1),d(0),h.current=0,f.current=0}},[s,o,u,n,t]);return(0,a.useEffect)(()=>{let e=m.current||document.body;return e.addEventListener("touchstart",p,{passive:!1}),e.addEventListener("touchmove",v,{passive:!1}),e.addEventListener("touchend",y,{passive:!0}),()=>{e.removeEventListener("touchstart",p),e.removeEventListener("touchmove",v),e.removeEventListener("touchend",y)}},[p,v,y]),{containerRef:m,isPulling:o,isRefreshing:c,pullDistance:u,canRefresh:u>=n}}({onRefresh:async()=>{await o.qQ.invalidateQueries(),await new Promise(e=>setTimeout(e,800))},enabled:i,threshold:80,resistance:2.5});return i?(0,r.jsxs)("div",{ref:c,className:"relative ".concat(n),style:{transform:d>0?"translateY(".concat(Math.min(d,100),"px)"):"none",transition:l?"none":"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[(l||u)&&(0,r.jsx)("div",{className:"\n            pull-to-refresh \n            ".concat(h||u?"active":"","\n          "),style:{opacity:Math.min(d/60,1),transform:"translateX(-50%) scale(".concat(Math.min(.8+d/200,1.2),")")},children:(0,r.jsx)(s.A,{className:"\n              w-5 h-5 text-primary\n              ".concat(u?"animate-spin":h?"rotate-180":"","\n            "),style:{transform:"rotate(".concat(Math.min(2*d,180),"deg)"),transition:u?"none":"transform 0.2s ease"}})}),(0,r.jsx)("div",{className:u?"opacity-80":"opacity-100",children:t}),l&&!h&&(0,r.jsx)("div",{className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-50",children:(0,r.jsx)("div",{className:"bg-black/70 text-white text-sm px-3 py-1 rounded-full backdrop-blur-sm",children:"Pull down to refresh"})}),h&&!u&&(0,r.jsx)("div",{className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-50",children:(0,r.jsx)("div",{className:"bg-primary/90 text-white text-sm px-3 py-1 rounded-full backdrop-blur-sm",children:"Release to refresh"})})]}):(0,r.jsx)("div",{className:n,children:t})}},53904:(e,t,n)=>{n.d(t,{A:()=>r});let r=(0,n(19946).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}}]);