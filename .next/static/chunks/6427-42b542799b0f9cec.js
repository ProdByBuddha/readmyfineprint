"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6427],{53999:(e,t,r)=>{r.d(t,{cn:()=>o});var s=r(52596),n=r(39688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,s.$)(t))}},73309:(e,t,r)=>{r.d(t,{bl:()=>a,lo:()=>o});var s=r(74671);let n=null;function o(){return n||(n=sessionStorage.getItem("app-session-id")||crypto.getRandomValues(new Uint8Array(16)).reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""),sessionStorage.setItem("app-session-id",n)),n}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o();if(!["GET","HEAD","OPTIONS"].includes((t.method||"GET").toUpperCase())){let n={...t.headers||{},"x-session-id":r},o=localStorage.getItem("jwt_access_token");o||(o=sessionStorage.getItem("jwt_access_token")),o&&(n.Authorization="Bearer ".concat(o));let a=await (0,s.fd)(e,{...t,headers:n});if(401===a.status&&o&&localStorage.getItem("jwt_refresh_token"))try{let r=await fetch("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:localStorage.getItem("jwt_refresh_token")}),credentials:"include"});if(r.ok){let o=r.headers.get("content-type");if(o&&o.includes("application/json")){let{tokens:o}=await r.json();localStorage.setItem("jwt_access_token",o.access),localStorage.setItem("jwt_refresh_token",o.refresh),sessionStorage.setItem("jwt_access_token",o.access),sessionStorage.setItem("jwt_refresh_token",o.refresh);let a={...n,Authorization:"Bearer ".concat(o.access)};return(0,s.fd)(e,{...t,headers:a})}}}catch(e){console.log("Token refresh failed for CSRF request:",e instanceof Error?e.message:"Unknown error"),localStorage.removeItem("jwt_access_token"),localStorage.removeItem("jwt_refresh_token")}return a}let a={...t.headers||{},"x-session-id":r},i=localStorage.getItem("jwt_access_token");i&&(a.Authorization="Bearer ".concat(i));let c=await fetch(e,{...t,headers:a,credentials:"include"});if(401===c.status&&i&&localStorage.getItem("jwt_refresh_token"))try{let r=await fetch("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:localStorage.getItem("jwt_refresh_token")}),credentials:"include"});if(r.ok){let s=r.headers.get("content-type");if(s&&s.includes("application/json")){let{tokens:s}=await r.json();localStorage.setItem("jwt_access_token",s.access),localStorage.setItem("jwt_refresh_token",s.refresh);let n={...a,Authorization:"Bearer ".concat(s.access)};return fetch(e,{...t,headers:n,credentials:"include"})}console.warn("Refresh endpoint returned non-JSON response")}else console.log("Token refresh failed with status:",r.status)}catch(e){console.log("Token refresh failed:",e instanceof Error?e.message:"Unknown error"),localStorage.removeItem("jwt_access_token"),localStorage.removeItem("jwt_refresh_token")}else c.status;let l=c.headers.get("x-session-id");return l&&l!==r&&(n=l,sessionStorage.setItem("app-session-id",l)),c}},74671:(e,t,r)=>{r.d(t,{fd:()=>o});class s{async getToken(e){if(this.token&&Date.now()<this.tokenExpiry)return this.token;if(this.fetchPromise)try{return await this.fetchPromise}catch(e){throw this.fetchPromise=null,e}this.fetchPromise=this.fetchTokenFromServer(e);try{let e=await this.fetchPromise;return this.fetchPromise=null,e}catch(e){throw this.fetchPromise=null,e}}async fetchTokenFromServer(e){try{let t=await fetch("/api/csrf-token",{method:"GET",headers:{"Content-Type":"application/json","x-session-id":e},credentials:"include"});if(!t.ok)throw Error("Failed to fetch CSRF token: ".concat(t.status));let r=await t.json();if(!r.csrfToken)throw Error("No CSRF token received from server");return this.token=r.csrfToken,this.tokenExpiry=Date.now()+this.TOKEN_VALIDITY,r.csrfToken}catch(e){throw e}}async addTokenToHeaders(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=await this.getToken(e);return{...t,"x-csrf-token":r}}catch(e){return t}}async fetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(["GET","HEAD","OPTIONS"].includes((t.method||"GET").toUpperCase()))return fetch(e,{...t,credentials:"include"});try{let s=await this.addTokenToHeaders(r,t.headers||{}),n=await fetch(e,{...t,headers:s,credentials:"include"});if(403===n.status){let s=await n.text();if(s.includes("CSRF")||s.includes("csrf")){this.clearToken();let s=await this.addTokenToHeaders(r,t.headers||{});return fetch(e,{...t,headers:s,credentials:"include"})}}return n}catch(e){throw e}}clearToken(){this.token=null,this.tokenExpiry=0,this.fetchPromise=null}hasValidToken(){return null!==this.token&&Date.now()<this.tokenExpiry}getCurrentToken(){return this.token}constructor(){this.token=null,this.tokenExpiry=0,this.TOKEN_VALIDITY=9e6,this.fetchPromise=null}}let n=new s;async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=sessionStorage.getItem("app-session-id")||"anonymous";return n.fetch(e,t,r)}},88145:(e,t,r)=>{r.d(t,{E:()=>i});var s=r(95155);r(12115);var n=r(74466),o=r(53999);let a=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...n}=e;return(0,s.jsx)("div",{className:(0,o.cn)(a({variant:r}),t),...n})}},88482:(e,t,r)=>{r.d(t,{BT:()=>l,Wu:()=>d,ZB:()=>c,Zp:()=>a,aR:()=>i,wL:()=>f});var s=r(95155),n=r(12115),o=r(53999);let a=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});a.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...n})});i.displayName="CardHeader";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});c.displayName="CardTitle";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...n})});l.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...n})});d.displayName="CardContent";let f=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...n})});f.displayName="CardFooter"},97168:(e,t,r)=>{r.d(t,{$:()=>l});var s=r(95155),n=r(12115),o=r(99708),a=r(74466),i=r(53999);let c=(0,a.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2 min-w-[2.5rem]",sm:"h-9 rounded-md px-3 min-w-[2.25rem]",lg:"h-11 rounded-md px-8 min-w-[2.75rem]",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:r,variant:n,size:a,asChild:l=!1,loading:d=!1,disabled:f,children:h,...u}=e,g=l?o.DX:"button",m=f||d;return(0,s.jsxs)(g,{className:(0,i.cn)(c({variant:n,size:a,className:r})),ref:t,disabled:m,"aria-disabled":m,"aria-busy":d,tabIndex:m?-1:0,...u,children:[d&&(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),h,d&&(0,s.jsx)("span",{className:"sr-only",children:"Loading..."})]})});l.displayName="Button"}}]);