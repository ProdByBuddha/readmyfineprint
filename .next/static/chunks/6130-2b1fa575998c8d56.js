"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6130],{6069:(e,t,r)=>{function a(){let e=sessionStorage.getItem("app-session-id");return e||(e=crypto.getRandomValues(new Uint8Array(16)).reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""),sessionStorage.setItem("app-session-id",e),console.log("Generated new session ID:",e)),e}function o(e){let t=sessionStorage.getItem("app-session-id");e&&e!==t&&(sessionStorage.setItem("app-session-id",e),console.log("Updated session ID:",e))}function n(e){return 403===e.status}function s(){window.dispatchEvent(new CustomEvent("consentRequired",{detail:{reason:"API request blocked - consent required"}}))}async function i(e){if(!e.ok){let t=await e.text()||e.statusText;if(n(e))try{let e=JSON.parse(t);"CONSENT_REQUIRED"===e.code&&s()}catch(e){s()}throw Error("".concat(e.status,": ").concat(t))}}async function c(e,t,r){let i=(null==r?void 0:r.headers)||{},c={"x-session-id":a(),...i};(null==r?void 0:r.body)&&(c["Content-Type"]="application/json");let l=await fetch(t,{method:e,headers:c,body:(null==r?void 0:r.body)?JSON.stringify(r.body):void 0,credentials:"include"}),d=l.headers.get("x-session-id");if(d&&o(d),!l.ok){let e=await l.text();if(n(l))try{let t=JSON.parse(e);"CONSENT_REQUIRED"===t.code&&s()}catch(e){s()}throw Error("HTTP ".concat(l.status,": ").concat(e))}return l}r.d(t,{AT:()=>c,qQ:()=>l});let l=new(r(87017)).E({defaultOptions:{queries:{queryFn:(e=>{let{on401:t}=e;return async e=>{let{queryKey:r}=e,c=await fetch(r[0],{headers:{"x-session-id":a()},credentials:"include"}),l=c.headers.get("x-session-id");if(l&&o(l),"returnNull"===t&&401===c.status)return null;if(n(c)){let e=await c.text();try{let t=JSON.parse(e);"CONSENT_REQUIRED"===t.code&&s()}catch(e){s()}throw Error("HTTP ".concat(c.status,": ").concat(e))}return await i(c),await c.json()}})({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,refetchIntervalInBackground:!1,notifyOnChangeProps:["data","error"],staleTime:1/0,gcTime:864e5,retry:!1,structuralSharing:!1},mutations:{retry:!1,onError:e=>{var t,r;(null==e||null==(t=e.message)?void 0:t.includes("403"))&&(null==e||null==(r=e.message)?void 0:r.includes("CONSENT_REQUIRED"))&&(console.log("Mutation error indicates consent required, triggering consent modal"),s())}}}})},36130:(e,t,r)=>{r.d(t,{xF:()=>d}),r(95155);var a=r(12115);r(97168),r(99840);var o=r(55411),n=r(73309);let s={necessary:!0,analytics:!1,marketing:!1},i=null,c=null,l=!1;function d(){let[e,t]=(0,a.useState)(!1),[r,d]=(0,a.useState)(!0),[u,h]=(0,a.useState)(0),{accepted:p,loading:g}=function(){let[e,t]=(0,a.useState)({accepted:!1,loading:!0,error:null}),r=(0,a.useCallback)(async()=>{try{if(!(document.cookie.includes("subscriptionToken")||document.cookie.includes("subscription_token")||localStorage.getItem("jwt_access_token")||localStorage.getItem("jwt_refresh_token")||localStorage.getItem("jwt_token")))try{let e=await (0,o.bl)("/api/auth/session",{method:"GET",credentials:"include"});if(e.ok){let t=await e.json();return t.authenticated&&t.user}e.status}catch(e){console.log("Session check failed, assuming unauthenticated:",e)}return!1}catch(e){return e instanceof Error&&!e.message.includes("401")&&console.warn("Failed to check authentication status:",e),!1}},[]),n=(0,a.useCallback)(async()=>{try{let e=await (0,o.bl)("/api/user/preferences/legal-disclaimer",{method:"GET",credentials:"include"});if(e.ok)return(await e.json()).accepted;return 401===e.status||429===e.status&&console.log("Rate limited loading disclaimer from database, using localStorage"),null}catch(e){return e instanceof Error&&!e.message.includes("401")&&console.warn("Failed to load legal disclaimer from database:",e),null}},[]),s=(0,a.useCallback)(async e=>{try{let t=await (0,o.bl)("/api/user/preferences/legal-disclaimer",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({accepted:e})});if(!t.ok){if(429===t.status)return console.log("Rate limited saving disclaimer to database, saved to localStorage only"),!0;if(401===t.status)return!0;throw Error("Failed to save legal disclaimer to database")}return!0}catch(e){return console.warn("Failed to save legal disclaimer to database:",e),!1}},[]),i=(0,a.useCallback)(async()=>{if(!e.loading){t(e=>({...e,loading:!0,error:null}));try{if(await r()){let e=await n();if(null!==e)t(t=>({...t,accepted:e,loading:!1}));else{let e="true"===localStorage.getItem("readmyfineprint-disclaimer-accepted");e&&await s(e)&&console.log("✅ Legal disclaimer acceptance migrated to database:",e),t(t=>({...t,accepted:e,loading:!1}))}}else{let e="true"===localStorage.getItem("readmyfineprint-disclaimer-accepted");t(t=>({...t,accepted:e,loading:!1}))}}catch(r){console.error("Failed to initialize legal disclaimer:",r);let e="true"===localStorage.getItem("readmyfineprint-disclaimer-accepted");t(t=>({...t,accepted:e,loading:!1,error:"Failed to sync with database, using local storage"}))}}},[r,n,s]),c=(0,a.useCallback)(async()=>{t(e=>({...e,accepted:!0}));let e=new Date().toISOString();localStorage.setItem("readmyfineprint-disclaimer-accepted","true"),localStorage.setItem("readmyfineprint-disclaimer-date",e);try{await r()&&(await s(!0)||t(e=>({...e,error:"Failed to sync disclaimer acceptance to database"})))}catch(e){console.warn("Failed to save disclaimer acceptance:",e),t(e=>({...e,error:"Disclaimer saved locally but failed to sync to database"}))}},[r,s]),l=(0,a.useCallback)(async()=>{t(e=>({...e,accepted:!1})),localStorage.removeItem("readmyfineprint-disclaimer-accepted"),localStorage.removeItem("readmyfineprint-disclaimer-date");try{await r()&&(await s(!1)||t(e=>({...e,error:"Failed to sync disclaimer revocation to database"})))}catch(e){console.warn("Failed to revoke disclaimer:",e),t(e=>({...e,error:"Disclaimer revoked locally but failed to sync to database"}))}},[r,s]);return(0,a.useEffect)(()=>{(async()=>{i()})()},[i]),(0,a.useEffect)(()=>{let e,t=()=>{clearTimeout(e),e=setTimeout(()=>{i()},1e3)};return window.addEventListener("authStateChanged",t),window.addEventListener("authUpdate",t),()=>{clearTimeout(e),window.removeEventListener("authStateChanged",t),window.removeEventListener("authUpdate",t)}},[i]),{accepted:e.accepted,loading:e.loading,error:e.error,acceptDisclaimer:c,revokeDisclaimer:l}}(),{isAccepted:w,loading:m}=function(){let[e,t]=(0,a.useState)({settings:s,isAccepted:!1,loading:!0,error:null}),r=(0,a.useCallback)(async()=>{try{let e=await (0,o.bl)("/api/auth/session",{method:"GET",credentials:"include"});if(e.ok){let t=await e.json();return t.authenticated&&t.user}return!1}catch(e){return console.warn("Failed to check authentication status:",e),!1}},[]),n=(0,a.useCallback)(async()=>{try{let e=await (0,o.bl)("/api/user/preferences/cookie-consent",{method:"GET",credentials:"include"});if(e.ok)return(await e.json()).cookieConsent;return null}catch(e){return console.warn("Failed to load cookie consent from database:",e),null}},[]),i=(0,a.useCallback)(async e=>{try{if(!(await (0,o.bl)("/api/user/preferences/cookie-consent",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)})).ok)throw Error("Failed to save cookie consent to database");return!0}catch(e){return console.warn("Failed to save cookie consent to database:",e),!1}},[]),c=(0,a.useCallback)(()=>{try{let e="true"===localStorage.getItem("cookie-consent-accepted"),t=localStorage.getItem("cookie-consent-settings"),r=s;if(t)try{r=JSON.parse(t)}catch(e){console.warn("Failed to parse stored cookie settings:",e)}return{accepted:e,settings:r}}catch(e){return console.warn("Failed to read localStorage cookie consent:",e),{accepted:!1,settings:s}}},[]),l=(0,a.useCallback)((e,t)=>{try{localStorage.setItem("cookie-consent-accepted",t.toString()),localStorage.setItem("cookie-consent-settings",JSON.stringify(e))}catch(e){console.warn("Failed to save to localStorage:",e)}},[]),d=(0,a.useCallback)(async()=>{t(e=>({...e,loading:!0,error:null}));try{if(await r()){let e=await n();if(e){let r=e.necessary||e.analytics||e.marketing;t(t=>({...t,settings:e,isAccepted:r,loading:!1}))}else{let{accepted:e,settings:r}=c();e&&await i(r)&&console.log("✅ Cookie consent migrated to database:",r),t(t=>({...t,settings:r,isAccepted:e,loading:!1}))}}else{let{accepted:e,settings:r}=c();t(t=>({...t,settings:r,isAccepted:e,loading:!1}))}}catch(a){console.error("Failed to initialize cookie consent:",a);let{accepted:e,settings:r}=c();t(t=>({...t,settings:r,isAccepted:e,loading:!1,error:"Failed to sync with database, using local storage"}))}},[r,n,i,c]),u=(0,a.useCallback)(async()=>{let e={necessary:!0,analytics:!0,marketing:!0};t(t=>({...t,settings:e,isAccepted:!0})),l(e,!0);try{await r()&&(await i(e)||t(e=>({...e,error:"Failed to sync cookie consent to database"})))}catch(e){console.warn("Failed to save cookie consent:",e),t(e=>({...e,error:"Cookie consent saved locally but failed to sync to database"}))}window.dispatchEvent(new CustomEvent("consentChanged"))},[r,i,l]),h=(0,a.useCallback)(async e=>{let a=e.necessary||e.analytics||e.marketing;t(t=>({...t,settings:e,isAccepted:a})),l(e,a);try{await r()&&(await i(e)||t(e=>({...e,error:"Failed to sync cookie consent to database"})))}catch(e){console.warn("Failed to save cookie consent:",e),t(e=>({...e,error:"Cookie consent saved locally but failed to sync to database"}))}window.dispatchEvent(new CustomEvent("consentChanged"))},[r,i,l]),p=(0,a.useCallback)(async()=>{let e={necessary:!0,analytics:!1,marketing:!1};t(t=>({...t,settings:e,isAccepted:!1})),localStorage.removeItem("cookie-consent-accepted"),localStorage.removeItem("cookie-consent-settings");try{await r()&&(await i(e)||t(e=>({...e,error:"Failed to sync cookie revocation to database"})))}catch(e){console.warn("Failed to revoke cookies:",e),t(e=>({...e,error:"Cookies revoked locally but failed to sync to database"}))}window.dispatchEvent(new CustomEvent("consentRevoked"))},[r,i]);return(0,a.useEffect)(()=>{d()},[d]),(0,a.useEffect)(()=>{let e=()=>{d()};return window.addEventListener("authStateChanged",e),window.addEventListener("authUpdate",e),()=>{window.removeEventListener("authStateChanged",e),window.removeEventListener("authUpdate",e)}},[d]),{settings:e.settings,isAccepted:e.isAccepted,loading:e.loading,error:e.error,acceptAllCookies:u,acceptCookies:h,revokeCookies:p,hasAnalytics:e.settings.analytics,hasMarketing:e.settings.marketing,acceptAll:u,revokeConsent:p}}();(0,a.useEffect)(()=>{if(g||m)return void d(!0);let e=p&&w;t(e),d(!1),i={status:e,timestamp:Date.now(),sessionId:(0,n.lo)()}},[p,w,g,m]);let y=(0,a.useCallback)(async()=>{let e=Date.now();if(i&&e-i.timestamp<3e4){t(i.status),d(!1);return}if(l)return void console.log("Consent check already in progress, skipping...");l=!0,d(!0);try{(0,n.lo)();let r=await (0,n.bl)("/api/consent/verify",{method:"POST",headers:{"Content-Type":"application/json"}});if(r.ok){let a=await r.json(),o=!0===a.hasConsented;i={status:o,timestamp:e,sessionId:(0,n.lo)()},t(o),h(e=>e+1)}else console.warn("Consent check failed with status:",r.status),i={status:!1,timestamp:e},t(!1)}catch(e){console.warn("Failed to verify consent with database:",e),i=null,t(!1)}finally{l=!1,d(!1)}},[]);(0,a.useEffect)(()=>{let e;(async()=>{let e=(0,n.lo)();if(i&&i.sessionId===e&&Date.now()-i.timestamp<3e4){t(i.status),d(!1);return}await y()})();let r=()=>{i=null,clearTimeout(e),e=window.setTimeout(()=>{console.log("Handling consent change - rechecking consent"),y()},100)},a=()=>{i=null,t(!1),d(!1),console.log("Consent revoked - enabling gray mode"),setTimeout(()=>{console.log("Re-checking consent after revocation"),y(),h(e=>e+1)},100)};return window.addEventListener("consentChanged",r),window.addEventListener("consentRevoked",a),()=>{clearTimeout(e),window.removeEventListener("consentChanged",r),window.removeEventListener("consentRevoked",a)}},[]);let f=async()=>{if(!r){d(!0);try{let e=await (0,o.rh)();if(!e.success){console.warn("Consent logging warning:",e.message),t(!1),d(!1);return}i={status:!0,timestamp:Date.now(),sessionId:(0,n.lo)()},window.dispatchEvent(new CustomEvent("consentChanged")),t(!0),d(!1),h(e=>e+1),console.log("Consent accepted successfully"),c&&clearTimeout(c),c=window.setTimeout(()=>{},2e3)}catch(e){console.warn("Consent logging failed:",e),t(!1),d(!1);return}}},E=async()=>{if(!r){d(!0);try{let e=(0,n.lo)();console.log("Revoking consent with session: ".concat(e.substring(0,16),"..."));let r=await (0,n.bl)("/api/consent/revoke",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip:"client-side-revoke",userAgent:navigator.userAgent})}),a=await r.json();a.success||console.warn("Failed to revoke consent in database:",a.message),i=null,t(!1),d(!1),c&&clearTimeout(c),h(e=>e+1),window.dispatchEvent(new CustomEvent("consentRevoked"))}catch(e){console.warn("Failed to revoke consent from database:",e),i=null,t(!1),d(!1),c&&clearTimeout(c),window.dispatchEvent(new CustomEvent("consentRevoked"))}}};return{isAccepted:e,isCheckingConsent:r,acceptAll:f,revokeConsent:E,forceUpdate:u}}},55411:(e,t,r)=>{r.d(t,{IG:()=>p,de:()=>y,ui:()=>c,gP:()=>m,YE:()=>w,c1:()=>g,Sf:()=>d,Vl:()=>u,rh:()=>f,bl:()=>o.bl,x0:()=>h,Zh:()=>E,XX:()=>l});var a=r(6069),o=r(73309),n=r(74671);class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}setupGlobalErrorHandlers(){window.addEventListener("error",e=>{var t;this.reportError({errorType:"frontend",severity:"high",message:e.message,stack:null==(t=e.error)?void 0:t.stack,url:e.filename,additionalContext:{lineno:e.lineno,colno:e.colno,globalError:!0}})}),window.addEventListener("unhandledrejection",e=>{var t;this.reportError({errorType:"frontend",severity:"high",message:"Unhandled promise rejection: ".concat(e.reason),stack:null==(t=e.reason)?void 0:t.stack,additionalContext:{promiseRejection:!0,reason:e.reason}})})}async reportApiError(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",a=this.determineSeverity(e);await this.reportError({errorType:"api",severity:a,message:"API Error: ".concat(e.message||e.toString()),stack:e.stack,additionalContext:{endpoint:t,method:r,status:e.status,statusText:e.statusText,apiError:!0}})}async reportNetworkError(e,t){await this.reportError({errorType:"network",severity:"medium",message:"Network Error: ".concat(e.message||"Connection failed"),additionalContext:{url:t,networkError:!0}})}async reportAuthError(e,t){await this.reportError({errorType:"authentication",severity:"medium",message:"Auth Error: ".concat(e),additionalContext:{...t,authError:!0}})}async reportError(e){if(this.isEnabled)try{let a,o=this.createErrorHash(e);if(this.reportedErrors.has(o))return;if(this.reportedErrors.add(o),this.reportedErrors.size>100){let e=Array.from(this.reportedErrors);this.reportedErrors=new Set(e.slice(-50))}let n={...e,url:e.url||window.location.href,additionalContext:{...e.additionalContext,userAgent:navigator.userAgent,timestamp:new Date().toISOString(),screenSize:"".concat(window.screen.width,"x").concat(window.screen.height),viewportSize:"".concat(window.innerWidth,"x").concat(window.innerHeight)}},s=0;for(;s<3;){try{let e=await fetch("/api/errors/report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include",signal:AbortSignal.timeout(1e4)});if(e.ok)return void console.log("Error reported to admin successfully");console.warn("Failed to report error to admin:",e.status),a=Error("HTTP ".concat(e.status))}catch(e){var t,r;if(a=e,console.warn("Error reporting attempt ".concat(s+1," failed:"),e.message),!(null==(t=e.message)?void 0:t.includes("fetch"))&&!(null==(r=e.name)?void 0:r.includes("Abort")))break}++s<3&&await new Promise(e=>setTimeout(e,1e3*Math.pow(2,s-1)))}console.error("Failed to report error after all attempts:",a)}catch(e){console.error("Error reporting failed:",e)}}determineSeverity(e){var t,r,a,o;return 401===e.status||403===e.status?"medium":e.status>=500?"high":(null==(t=e.message)?void 0:t.includes("Network Error"))||(null==(r=e.message)?void 0:r.includes("Failed to fetch"))?"medium":(null==(a=e.message)?void 0:a.includes("TypeError"))||(null==(o=e.message)?void 0:o.includes("ReferenceError"))?"high":"medium"}createErrorHash(e){return btoa("".concat(e.errorType,":").concat(e.message,":").concat(e.url)).substring(0,16)}setEnabled(e){this.isEnabled=e}async reportCriticalError(e,t){await this.reportError({errorType:"frontend",severity:"critical",message:e,additionalContext:{...t,critical:!0}})}constructor(){this.isEnabled=!0,this.reportedErrors=new Set,this.setupGlobalErrorHandlers()}}let i=s.getInstance();async function c(e){let t=await (0,o.bl)("/api/documents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e,r="Failed to create document: ".concat(t.statusText);try{let e=await t.text();try{let t=JSON.parse(e);t.error&&(r=t.error)}catch(t){e.includes("<!DOCTYPE")?r="Server error occurred. Please refresh the page and try again.":e&&(r=e)}}catch(e){console.error("Failed to read error response:",e)}throw e=Error(r),i.reportApiError(e,"/api/documents","POST"),Error(r)}try{let e=await t.text();return JSON.parse(e)}catch(e){throw console.error("Failed to parse JSON response:",e),Error("Server returned invalid response. Please refresh the page and try again.")}}async function l(e){let t=new FormData;t.append("file",e);let r=await (0,o.bl)("/api/documents/upload",{method:"POST",body:t});if(!r.ok)try{let e=await r.text();try{let t=JSON.parse(e);throw Error(t.error||e)}catch(t){throw Error(e||"Upload failed: ".concat(r.statusText))}}catch(e){throw Error("Upload failed: ".concat(r.statusText))}try{return await r.json()}catch(e){throw console.error("Failed to parse upload response:",e),Error("Server returned invalid response. Please try again.")}}async function d(){let e=await fetch("/api/security-questions/available",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok)try{let t=await e.text();try{let r=JSON.parse(t);throw Error(r.error||"HTTP error! status: ".concat(e.status))}catch(r){throw Error(t||"HTTP error! status: ".concat(e.status))}}catch(t){throw Error("HTTP error! status: ".concat(e.status))}try{return await e.json()}catch(e){throw console.error("Failed to parse security questions response:",e),Error("Server returned invalid response. Please try again.")}}async function u(){let e=await fetch("/api/security-questions/user",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok)try{let t=await e.text();try{let r=JSON.parse(t);throw Error(r.error||"HTTP error! status: ".concat(e.status))}catch(r){throw Error(t||"HTTP error! status: ".concat(e.status))}}catch(t){throw Error("HTTP error! status: ".concat(e.status))}try{return await e.json()}catch(e){throw console.error("Failed to parse getUserSecurityQuestions response:",e),Error("Server returned invalid response. Please try again.")}}async function h(e){let t=await (0,n.fd)("/api/security-questions/setup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)try{let e=await t.text();try{let r=JSON.parse(e);throw Error(r.error||"HTTP error! status: ".concat(t.status))}catch(r){throw Error(e||"HTTP error! status: ".concat(t.status))}}catch(e){throw Error("HTTP error! status: ".concat(t.status))}try{return await t.json()}catch(e){throw console.error("Failed to parse setupSecurityQuestions response:",e),Error("Server returned invalid response. Please try again.")}}async function p(e){let t={},r=localStorage.getItem("deviceFingerprint");r&&(t["x-device-fingerprint"]=r);let o=await (0,a.AT)("POST","/api/documents/".concat(e,"/analyze"),{headers:t});if(!o.ok)try{let e=await o.text();try{let t=JSON.parse(e);throw Error(t.error||"Failed to analyze document")}catch(t){throw Error(e||"Failed to analyze document")}}catch(e){throw Error("Failed to analyze document")}try{return await o.json()}catch(e){throw console.error("Failed to parse analyzeDocument response:",e),Error("Server returned invalid response. Please try again.")}}async function g(){let e=await (0,o.bl)("/api/queue/status",{method:"GET"});if(!e.ok)try{let t=await e.text();throw Error("HTTP ".concat(e.status,": ").concat(t))}catch(t){throw Error("HTTP ".concat(e.status,": ").concat(e.statusText))}try{return await e.json()}catch(e){throw console.error("Failed to parse getQueueStatus response:",e),Error("Server returned invalid response. Please try again.")}}async function w(e){let t=await (0,o.bl)("/api/documents/".concat(e),{method:"GET",credentials:"include"});if(!t.ok)try{let e=await t.text();try{let t=JSON.parse(e);throw Error(t.error||"Failed to fetch document")}catch(t){throw Error(e||"Failed to fetch document")}}catch(e){throw Error("Failed to fetch document")}try{return await t.json()}catch(e){throw console.error("Failed to parse getDocument response:",e),Error("Server returned invalid response. Please try again.")}}async function m(){let e=await (0,o.bl)("/api/documents",{method:"GET",credentials:"include"});if(!e.ok)try{let t=await e.text();try{let e=JSON.parse(t);throw Error(e.error||"Failed to fetch documents")}catch(e){throw Error(t||"Failed to fetch documents")}}catch(e){throw Error("Failed to fetch documents")}try{return await e.json()}catch(e){throw console.error("Failed to parse getAllDocuments response:",e),Error("Server returned invalid response. Please try again.")}}async function y(){let e=await (0,o.bl)("/api/documents",{method:"DELETE",headers:{}});if(!e.ok)try{let t=await e.text();try{let e=JSON.parse(t);throw Error(e.error||"Failed to clear documents")}catch(e){throw Error(t||"Failed to clear documents")}}catch(e){throw Error("Failed to clear documents")}try{return await e.json()}catch(e){throw console.error("Failed to parse clearAllDocuments response:",e),Error("Server returned invalid response. Please try again.")}}async function f(){try{let e=(0,o.lo)();console.log("API: Logging consent with session: ".concat(e.substring(0,16),"..."));let t=await (0,o.bl)("/api/consent",{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok)try{let e=await t.text();try{let t=JSON.parse(e);throw Error(t.error||"Failed to log consent")}catch(t){throw Error(e||"Failed to log consent")}}catch(e){throw Error("Failed to log consent")}try{return await t.json()}catch(e){throw console.error("Failed to parse logConsent response:",e),Error("Server returned invalid response. Please try again.")}}catch(e){return console.warn("Consent logging failed:",e),{success:!1,message:"Consent logging failed, but you can continue using the service"}}}async function E(e){let t=(0,o.lo)(),r=await (0,n.fd)("/api/rlhf/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,sessionId:t})});if(!r.ok){let e="Failed to submit feedback: ".concat(r.statusText);try{let t=await r.text();try{let r=JSON.parse(t);r.error&&(e=r.error)}catch(r){t&&(e=t)}}catch(e){}throw Error(e)}try{return await r.json()}catch(e){throw console.error("Failed to parse submitPiiDetectionFeedback response:",e),Error("Server returned invalid response. Please try again.")}}},99840:(e,t,r)=>{r.d(t,{Cf:()=>u,L3:()=>p,c7:()=>h,lG:()=>c,rr:()=>g});var a=r(95155),o=r(12115),n=r(15452),s=r(54416),i=r(53999);let c=n.bL;n.l9;let l=n.ZL;n.bm;let d=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,a.jsx)(n.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...o})});d.displayName=n.hJ.displayName;let u=o.forwardRef((e,t)=>{let{className:r,children:o,hideCloseButton:c,...u}=e;return(0,a.jsxs)(l,{children:[(0,a.jsx)(d,{}),(0,a.jsxs)(n.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...u,children:[o,!c&&(0,a.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-all hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 w-6 h-6 flex items-center justify-center",children:[(0,a.jsx)(s.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=n.UC.displayName;let h=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};h.displayName="DialogHeader";let p=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,a.jsx)(n.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",r),...o})});p.displayName=n.hE.displayName;let g=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...o})});g.displayName=n.VY.displayName}}]);