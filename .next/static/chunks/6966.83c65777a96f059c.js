"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6966],{56966:(e,a,r)=>{r.r(a),r.d(a,{DocumentHistory:()=>v});var s=r(95155),t=r(12115),l=r(32960),n=r(5041),c=r(88482),i=r(97168),d=r(88145),o=r(47655),x=r(53999);let m=t.forwardRef((e,a)=>{let{className:r,children:t,...l}=e;return(0,s.jsxs)(o.bL,{ref:a,className:(0,x.cn)("relative overflow-hidden",r),...l,children:[(0,s.jsx)(o.LM,{className:"h-full w-full rounded-[inherit]",children:t}),(0,s.jsx)(h,{}),(0,s.jsx)(o.OK,{})]})});m.displayName=o.bL.displayName;let h=t.forwardRef((e,a)=>{let{className:r,orientation:t="vertical",...l}=e;return(0,s.jsx)(o.VM,{ref:a,orientation:t,className:(0,x.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...l,children:(0,s.jsx)(o.lr,{className:"relative flex-1 rounded-full bg-border"})})});h.displayName=o.VM.displayName;var u=r(14186),g=r(75525),y=r(1243),p=r(54861),b=r(57434),f=r(62525),j=r(55411),N=r(89677),w=r(53580),k=r(6069);let v=(0,t.memo)(e=>{let{onSelectDocument:a,currentDocumentId:r}=e,[o,x]=(0,t.useState)(!1),{toast:h}=(0,w.dj)(),{data:v=[],isLoading:A,isFetching:C}=(0,l.I)({queryKey:["/api/documents"],queryFn:j.gP,staleTime:1/0,gcTime:1/0,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,notifyOnChangeProps:["data","error"],structuralSharing:!1}),D=(0,n.n)({mutationFn:j.de,onSuccess:()=>{a(null),k.qQ.removeQueries({queryKey:["/api/documents"]}),h({title:"Documents cleared",description:"All documents have been cleared. You can start fresh!"})},onError:e=>{h({title:"Failed to clear documents",description:e instanceof Error?e.message:"An error occurred",variant:"destructive"})}}),E=(0,t.useCallback)(()=>{window.confirm("Are you sure you want to clear all documents? This action cannot be undone.")&&D.mutate()},[D]),R=(0,t.useMemo)(()=>v.sort((e,a)=>new Date(a.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(0,o?v.length:3),[v,o]),O=(0,t.useCallback)(e=>{if(!e)return(0,s.jsx)(u.A,{className:"w-4 h-4 text-gray-400"});switch(e.overallRisk){case"low":return(0,s.jsx)(g.A,{className:"w-4 h-4 text-green-600"});case"moderate":return(0,s.jsx)(y.A,{className:"w-4 h-4 text-yellow-600"});case"high":return(0,s.jsx)(p.A,{className:"w-4 h-4 text-red-600"});default:return(0,s.jsx)(u.A,{className:"w-4 h-4 text-gray-400"})}},[]),S=(0,t.useCallback)(e=>{if(!e)return"bg-gray-100 text-gray-600";switch(e.overallRisk){case"low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"moderate":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"high":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";default:return"bg-gray-100 text-gray-600"}},[]);return A&&!v.length?(0,s.jsx)(c.Zp,{className:"mb-8 stable-height",children:(0,s.jsx)(c.Wu,{className:"p-6",children:(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-5/6"})]})]})})}):0===v.length?null:(0,s.jsxs)(c.Zp,{className:"mb-8",children:[(0,s.jsx)(c.aR,{className:"pb-3",children:(0,s.jsxs)(c.ZB,{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 min-w-0",children:[(0,s.jsx)(b.A,{className:"w-5 h-5 text-primary flex-shrink-0"}),(0,s.jsx)("span",{className:"text-sm sm:text-base",children:"Current Session"}),(0,s.jsx)(d.E,{variant:"secondary",className:"flex-shrink-0",children:v.length})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[v.length>3&&(0,s.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>x(!o),className:"text-xs px-2 py-1 h-7",children:o?"Less":"All"}),(0,s.jsxs)(i.$,{variant:"outline",size:"sm",onClick:E,disabled:D.isPending,className:"text-xs px-2 py-1 h-7",children:[(0,s.jsx)(f.A,{className:"w-3 h-3 mr-1"}),"Clear"]})]})]})}),(0,s.jsxs)(c.Wu,{children:[(0,s.jsx)(m,{className:o?"h-96":"h-auto",children:(0,s.jsx)("div",{className:"space-y-3",style:{minHeight:C?"100px":"auto"},children:R.map(e=>{let t=e.analysis,l=r===e.id;return(0,s.jsx)("div",{className:"border rounded-lg p-3 cursor-pointer transition-colors hover:bg-gray-50 dark:hover:bg-gray-800 ".concat(l?"border-primary bg-primary/5":"border-gray-200 dark:border-gray-700"),onClick:()=>a(e.id),onKeyDown:r=>{("Enter"===r.key||" "===r.key)&&(r.preventDefault(),a(e.id))},role:"button",tabIndex:0,"aria-label":"Select document: ".concat(e.title),children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-start gap-2 min-w-0",children:[(0,s.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:O(t)}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white text-sm leading-tight line-clamp-2",children:e.title})}),t&&(0,s.jsx)(d.E,{className:"text-[10px] px-1.5 py-0.5 flex-shrink-0 ".concat(S(t)),children:t.overallRisk})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 text-xs text-gray-500 dark:text-gray-400",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[(0,s.jsxs)("span",{className:"flex-shrink-0",children:[e.content.split(" ").length,"w"]}),(0,s.jsx)("span",{className:"truncate",children:(0,N.m)(new Date(e.createdAt),{addSuffix:!0})})]}),!t&&(0,s.jsx)(d.E,{variant:"outline",className:"text-[10px] px-1.5 py-0.5 flex-shrink-0",children:"Pending"})]}),t&&(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300 line-clamp-2 leading-relaxed",children:t.summary})]})},e.id)})})}),(0,s.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"Documents are stored in your current session only. Opening a new browser will clear all data."})})]})]})})}}]);